#include <stdio.h>

int main(void) {
    /* agenda[dia][slot] = 0 libre, 1 reservado
       dias: 0..4  (0=Lunes, 4=Viernes)
       slots: 0..8 (0=9-10, ..., 8=17-18) */
    int agenda[5][9] = {0};

    const char *diasN[5] = {"Lunes", "Martes", "Miércoles", "Jueves", "Viernes"};
    const char *horasN[9] = {
        "09:00-10:00", "10:00-11:00", "11:00-12:00",
        "12:00-13:00", "13:00-14:00", "14:00-15:00",
        "15:00-16:00", "16:00-17:00", "17:00-18:00"
    };

    int opcion;
    do {
        printf("\n=== AGENDA JUANITO (paseo de perros) ===\n");
        printf("1) Agendar contrato\n");
        printf("2) Mostrar agenda\n");
        printf("3) Salir\n");
        printf("Elija una opcion: ");
        if (scanf("%d", &opcion) != 1) {
            int c; while ((c = getchar()) != '\n' && c != EOF);
            opcion = -1;
        }

        switch (opcion) {
            case 1: {
                int d_in, s_in;
                int d_idx = -1, s_idx = -1;  // índices validados (base 0)

                printf("\n--- Agendar contrato ---\n");
                printf("Dias: 1=Lunes, 2=Martes, 3=Miércoles, 4=Jueves, 5=Viernes\n");
                printf("Ingrese dia (1-5): ");
                if (scanf("%d", &d_in) != 1) { int c; while ((c=getchar())!='\n' && c!=EOF); d_in = -1; }

                /* Validación/mapa de día con switch */
                switch (d_in) {
                    case 1: d_idx = 0; break;
                    case 2: d_idx = 1; break;
                    case 3: d_idx = 2; break;
                    case 4: d_idx = 3; break;
                    case 5: d_idx = 4; break;
                    default: d_idx = -1; break;
                }
                if (d_idx == -1) {
                    printf("** Error: dia fuera de rango (1-5).\n");
                    break; /* vuelve al menú */
                }

                printf("\nFranjas horarias:\n");
                for (int i = 0; i < 9; i++) printf("%d) %s\n", i+1, horasN[i]);
                printf("Ingrese franja (1-9): ");
                if (scanf("%d", &s_in) != 1) { int c; while ((c=getchar())!='\n' && c!=EOF); s_in = -1; }

                /* Validación/mapa de franja con switch */
                switch (s_in) {
                    case 1: s_idx = 0; break;
                    case 2: s_idx = 1; break;
                    case 3: s_idx = 2; break;
                    case 4: s_idx = 3; break;
                    case 5: s_idx = 4; break;
                    case 6: s_idx = 5; break;
                    case 7: s_idx = 6; break;
                    case 8: s_idx = 7; break;
                    case 9: s_idx = 8; break;
                    default: s_idx = -1; break;
                }
                if (s_idx == -1) {
                    printf("** Error: franja fuera de rango (1-9).\n");
                    break; /* vuelve al menú */
                }

                /* Chequeo de conflicto y reserva */
                switch (agenda[d_idx][s_idx]) {
                    case 0:
                        agenda[d_idx][s_idx] = 1;
                        printf("OK: reservado %s %s.\n", diasN[d_idx], horasN[s_idx]);
                        break;
                    case 1:
                        printf("** Conflicto: %s %s ya está RESERVADO.\n", diasN[d_idx], horasN[s_idx]);
                        break;
                    default:
                        printf("** Estado desconocido.\n");
                        break;
                }
                break;
            }

            case 2: {
                printf("\n--- Mostrar agenda ---\n");
                /* Encabezado de horas */
                printf("%-12s", "");
                for (int s = 0; s < 9; s++) printf("%-13s", horasN[s]);
                printf("\n");

                /* Filas por día */
                for (int d = 0; d < 5; d++) {
                    printf("%-12s", diasN[d]);
                    for (int s = 0; s < 9; s++) {
                        switch (agenda[d][s]) {
                            case 0: printf("%-13s", "LIBRE"); break;
                            case 1: printf("%-13s", "RESERVADO"); break;
                            default: printf("%-13s", "?"); break;
                        }
                    }
                    printf("\n");
                }

                /* Resumen */
                int libres = 0, ocupados = 0;
                for (int d = 0; d < 5; d++)
                    for (int s = 0; s < 9; s++)
                        switch (agenda[d][s]) {
                            case 0: libres++; break;
                            case 1: ocupados++; break;
                            default: break;
                        }
                printf("\nTotal LIBRE: %d | Total RESERVADO: %d\n", libres, ocupados);
                break;
            }

            case 3:
                printf("Saliendo...\n");
                break;

            default:
                printf("** Opción inválida. Intente de nuevo.\n");
                break;
        }

    } while (opcion != 3);

    return 0;
}
